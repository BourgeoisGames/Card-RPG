{"version":3,"sources":["src/app.js","src/environment.js","src/main.js","src/scriptinjector.js","src/game_logic/engine.js","src/resources/index.js","src/views/gameview.js"],"names":["App","flame_img_url","debug","testing","configure","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","scriptinjector","defaultBindingMode","oneWay","attached","url","scripttag","document","createElement","isAsync","async","setAttribute","body","appendChild","detached","remove","is_type","x","y","undefined","is_array","Array","isArray","is_type_array","every","e","is_object_type_array","is_union_type","some","is_primitive","is_datum","is_data_object","is_data_pair","Object","entries","is_value","copy","JSON","parse","stringify","is_event","event_id","data","is_script_reference","id","args","is_executable","scripts","is_script","script","is_trigger_list","game_data_model","schema","game_controller","state","data_model","add_trigger","that","triggers","trigger_id","signal_id","script_reference","signals","push","remove_trigger","arr","index","indexOf","splice","add_script","validate_game_data","bad_data","forEach","obj_type","bad_instances","type_id","objl","obj","length","get_by_type_and_id","type","tid","get_script","sid","get_triggers","ans","handle_error","err","console","log","run_script","ref","interrupted","full_args","sc","halt_stack","resume_stack","clear_stack","trigger","tr","trigger_args","config","yuri","yuri2","yuri3","classroom","spiderweb","bullying","rooms","message","img","background","newroom","gc","room","shift","keys","gameview","game","game_state","send_click"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n    //this.event = new Event('just monika')\n    this.flame_img_url = \"https://media.giphy.com/media/fly1dGJ5CekcU/giphy.gif\";\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import {bindingMode, customElement, bindable, noView} from \"aurelia-framework\";\n \n@noView()\n@customElement('scriptinjector')\nexport class scriptinjector {\n \n  @bindable url;\n  @bindable isAsync;\n  @bindable({defaultBindingMode: bindingMode.oneWay}) scripttag;\n \n  attached() {\n    if (this.url) {\n      this.scripttag = document.createElement('script');\n      if (this.isAsync) {\n        this.scripttag.async = true;\n      }\n      this.scripttag.setAttribute('src', this.url);\n      document.body.appendChild(this.scripttag);\n    }\n  }\n \n  detached() {\n    if (this.scripttag) {\n      this.scripttag.remove();\n    }\n  }\n}","//some utilities\n\n//alert(\"hell\");\n\nvar is_type = (x, y) => (x !== undefined) && (typeof x == y); //check if primitive fields are the correct primitive\nvar is_array = x => Array.isArray(x);\nvar is_type_array = (x,y) => is_array(x) && x.every(e => is_type(e,y));\nvar is_object_type_array = (x,y) => is_array(x) && x.every(y);\nvar is_union_type = (x,y) => is_type_array(y,\"string\") && y.some(e => is_type(x,e));\nvar is_primitive = x => is_union_type(x,[\"string\",\"number\",\"boolean\"]) || is_object_type_array(x,is_primitive);\nvar is_datum = x => is_primitive(x) || is_data_object(x) || is_object_type_array(is_data_object);\nvar is_data_pair = x => is_array(x) && is_type(x[0],\"string\") && is_datum(x[1]);\nvar is_data_object = x => is_type(x,\"object\") && Object.entries(x).every(is_data_pair);\nvar is_value = (x,y) => x == y;\n\nvar copy = x => JSON.parse(JSON.stringify(x));\n\n//the meat\n\nvar is_event = x => is_data_object(x) && is_type(x.event_id,\"string\") && is_type(x.data,\"object\");//data is mutable, and used to store whatever the dickens\n\n//var is_display_data = x => is_type(x.display_id,\"string\") && is_type(x.args,\"object\");\n\n//var is_displayable = x => is_display_data(x.display_data);\n\nvar is_script_reference = x => is_type(x,\"object\") && is_type(x.id, \"string\") && is_type(x.args,\"object\");\n\nvar is_executable = x => is_type(x,\"object\") && is_object_type_array(x.scripts,is_script_reference);\n\nvar is_script = x => is_type(x,\"object\") && is_type(x.id,\"string\") && is_type(x.script,\"function\"); //should take in a game state object, an arguments object, and \n\n//var is_trigger = x => is_data_object(x) && is_type(x,\"object\") && is_type(x.signal_id,\"string\") && is_script_reference(x.id);\n\nvar is_trigger_list = x => is_type_array(x,\"string\");//eventids\n\n//is_message_event = x => is_event(x) && is_value(x.event_type,\"message\") && is_type(x.event_data.message, \"string\");\n\n//is_messages_event = x => is_event(x) && is_value(x.event_type,\"messages\") && is_type_array(x.event_data.messages, \"string\");\n\n//test_message_event = {message: \"my heart is pounding!\"};\n\n//test_messages_event = {messages: [\"my heart is pounding!\",\"I slice the bread, and feed myself again\"]};\n\n//test_script_event = {script_id: \"the epiphony\", args: {\"reality\":false, \"love\":\"player-kun\", \"yandere_score\":Number.MAX_VALUE}};\n\n//test_bad_script_event = {script_id: \"sayori's room\", args: {\"reaction\": w => (x => x(x))((x => x(x)))}};\n\nvar game_data_model = {};//this is loaded, and then static, and should NEVER mutate\n//game_data_model.triggers = {schema:is_trigger_list,data:{}};//triggers WILL CHANGE\n//game_data_model.events = {schema:is_event,data:{}};\ngame_data_model.scripts = {schema:is_script,data:{}};\ngame_data_model.data = {};\n\n//sig = {\"signal_id\":\"dialogue_option_1\", \"data\":{\"bullying\":false}};//this is from aurelia, and gets sent to the game_controller\n\n//quetzalcuatl = {\"signal_id\":\"dialogue_option_1\", \"event_id\":\"player_rejects_confession\"}//triggers have data too;\n\n//tezcotlipoca = {\"event_id\":\"player_accepts_confession\", \"data\":{\"sayori's heart\":\"broken\"}} //if no scripts apply; is_event -> true\n\n//xochiquetzal = {\"event_id\":\"player_accepts_confession\", \"data\":{\"sayori's heart\":\"broken\"}, \"scripts\":[xipe]}//is_event -> true; is_executable -> true\n\n//{\"sayori's heart\":\"broken\", \"trigger_data\":{\"bullying\":false}}\n\n//xipe = {\"id\":\"sayori's room\", \"args\":{\"items\":[\"rope\",\"tears\"]}}\n\n//\n\n//tlazal = {id:\"sayori's room\", script:w => (x => x(x))((x => x(x)))}\n\n//w => (x => x(x))((x => x(x))) //kill yourself\n\n//////////////////////////////////\nvar game_controller = {};\ngame_controller.state = {\n  \"interrupted\":false,\n  \"script_stack\":[],\n  \"triggers\":{},//trigger_id, script_id\n  \"signals\":{},//signal_id, [trigger_ids]\n  \"data\":{}\n};//require(\"./game_state_prototype.json\"); //this is the only non-temporary, mutable object in the game!!!\ngame_controller.data_model = game_data_model;//never touch this directly\n\ngame_controller.add_trigger = function(x){//x = {trigger_id:\"\", signal_id:\"\", script_reference:{some script reference}}\n  var that = this; \n  that.state.triggers[x.trigger_id] = {\"signal_id\":x.signal_id, \"script_reference\":x.script_reference};\n  if(!that.state.signals[x.signal_id]){that.state.signals[x.signal_id] = [];}\n  that.state.signals[x.signal_id].push(x.trigger_id);\n};\n\ngame_controller.remove_trigger = function(x){\n  var that = this; \n  var arr = that.state.signals[that.state.triggers[x].signal_id]\n  var index = arr.indexOf(x);\n  if (index !== -1) arr.splice(index, 1);\n  that.state.triggers[x] = undefined;\n};\n//game_controller.add_game_event = function(x){var that = this.data_model; that.events.data[x.event_id] = x;};\ngame_controller.add_script = function(x){var that = this; that.data_model.scripts.data[x.id] = x;};\n\ngame_controller.validate_game_data = function(){\n  var that = this.data_model;\n  var bad_data = {};\n  Object.entries(that).forEach(function(obj_type){\n    var bad_instances = [];\n    var type_id = obj_type[0];\n    var schema = obj_type[1].schema;\n    if (!schema) {return 1;}\n    Object.entries(obj_type[1].data).forEach(function(objl){\n      var obj = objl[1]\n      if(!schema(obj)){\n        bad_instances.push(obj);\n      }\n    });\n    if(bad_instances.length > 0){\n      bad_data[type_id] = bad_instances;\n    }\n  });\n  return bad_data\n};\n\ngame_controller.get_by_type_and_id = function(type,tid){\n  var that = this;\n  return that.data_model[type][tid];\n};\n\ngame_controller.get_script = function(sid){\n  var that = this;\n  return that.data_model.scripts.data[sid];\n};\n\n\n\n/*game_controller.get_event = function(eid){\n  var that = this;\n  return copy(that.get_by_type_and_id(\"events\",eid));\n};*/\n\ngame_controller.get_triggers = function(tid){\n  var that = this;\n  var ans = that.state.signals[tid];\n  if (ans) {return ans;}\n  return [];\n};\n\ngame_controller.handle_error = function(err){\n  console.log(err);\n};\n\ngame_controller.run_script = function(ref, args){//takes a script reference and list of arguments\n  var that = this;\n  if (that.interrupted) {return 1;}\n  var full_args = copy(ref.args)\n  var sc = that.get_script(ref.id).script;\n  \n  return sc(that,full_args);\n};\n\ngame_controller.halt_stack = function(tid){\n  var that = this;\n  return that.interrupted = true;\n};\n\ngame_controller.resume_stack = function(tid){\n  var that = this;\n  return copy(that.state.signals[tid]);\n};\n\ngame_controller.clear_stack = function(tid){\n  var that = this;\n  return copy(that.state.signals[tid]);\n};\n\n/*game_controller.execute_script = function(sid, args){\n  var that = this;\n  that.get_script(sid)(that,args);\n};\n\ngame_controller.push_event = function(eid,data_obj){\n  var that = this;\n  var ev = that.get_event(eid)(that.state,args);\n  ev.data.call_data = data_obj;\n  that.state.event_stack.push(ev);\n};\n\ngame_controller.create_and_push_event = function(ev){//this is weird\n  var that = this;\n  that.state.event_stack.push(ev);\n};\n\ngame_controller.end_event = function(){//do not use!!\n  var that = this;\n  var ev = that.state.event_stack.pop();\n  that.state.current_event = ev;\n};*/\n\n/*game_controller.execute_event = function(){//never use\n  var that = this;\n  var ev = that.state.current_event;\n  var unloaded = !ev;\n  if(ev && is_executable(ev)){\n    ev.scripts.forEach(function (scr){\n      var args2 = clone(src.args)\n      args2.event_data = ev.data\n      args2.trigger_data = ev.trigger_data\n      that.execute_script(src.id, args2);\n    });\n  }\n  that.end_event();\n  if(unloaded){\n    that.execute_event;\n  }\n};*/\n\n/*game_controller.execute_event_stack = function(){//use this instead\n  var that = this;\n  that.execute_event();\n  var ev = !that.state.current_event;\n  if(!ev){\n    that.execute_event();\n  }\n  ev = !that.state.current_event;\n  if(ev){\n    that.execute_event_stack();\n  }\n};*/\n\ngame_controller.trigger = function(signal_id,args){\n  var that = this;\n  that.state.interrupted = false;\n  that.get_triggers(signal_id).forEach(function(tid){\n    var tr = copy(that.state.triggers[tid]);\n    var ref = tr.script_reference;\n    ref.args.trigger_args = copy(args)\n    that.run_script(ref);\n  });\n\n  that.interrupted = false;\n};\n\nexport default game_controller;\n\n//document.write(\"asdsaaf\");\n\n//module.exports = game_controller;","export function configure(config) {\n  //config.globalResources([]);\n}\n","import game from \"../game_logic/engine\"\n\nvar yuri = \"https://vignette.wikia.nocookie.net/doki-doki-literature-club/images/7/72/Yuri_school_1.png/revision/latest?cb=20171112095243\";\nvar yuri2 = \"https://vignette.wikia.nocookie.net/doki-doki-literature-club/images/1/19/Yurifull1.png/revision/latest?cb=20171203145750\";\nvar yuri3 = \"https://cdn140.picsart.com/251511791012212.png?r240x240\";\nvar classroom = \"https://vignette.wikia.nocookie.net/doki-doki-literature-club/images/8/87/Alt_classroom.jpeg/revision/latest?cb=20171211171811\";\nvar spiderweb = \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuz8PqsGP11FE5pFLY72RpulXoUM9XHtWEMrAZy7T3IGbEd_bX\";\nvar bullying = \"https://lparchive.org/Doki-Doki-Literature-Club/Update%2027/24-kJ6nlqg.gif\";\n\nvar rooms = [\n{\n\tmessage:\"\\\"❤ Hi Player-san ❤\\\"\",\n\timg:yuri,\n\tbackground:classroom\n},\n{\n\tmessage:\"\\\"❤ I was hoping I'd get a chance to see you here ❤\\\"\"\n},\n{\n\tmessage:\"\\\"... but ...\\\"\"\n},\n{\n\tmessage:\"\\\"...\\\"\"\n},\n{\n\tmessage:\"\\\"The falling stars you wished upon\\\"\"\n},\n{\n\tmessage:\"\\\"are cinders now, and now they're gone\\\"\"\n},\n{\n\tmessage:\"\\\"their residue festoons my fetid fields.\\\"\",\n\tbackground:spiderweb\n},\n{\n\tmessage:\"\\\"The withered husks of lovers past\\\"\"\n},\n{\n\tmessage:\"\\\"the shells are all that ever last\\\"\"\n},\n{\n\tmessage:\"\\\"I've taken everything that they've concealed.\\\"\"\n},\n{\n\tmessage:\"\\\"...\\\"\",\n\timg:yuri2\n},\n{\n\tmessage:\"\\\"Who ever told you life was fair?\\\"\",\n\timg:yuri3\n},\n{\n\tmessage:\"Say no to bullying\",\n\timg:null,\n\tbackground:bullying\n}\n];\n\nvar newroom = function(gc,args) {\n\tvar room = gc.state.data.rooms.shift();\n\tif (!room) {return 1;}\n\tObject.keys(room).forEach(function(x){\n\t\tgc.state.data.room[x] = room[x];\n\t});\n};\ngame.add_script({\"id\":\"newroom\",\"script\":newroom});\ngame.add_trigger({\"trigger_id\":\"click_to_next\", \"signal_id\":\"click\", \"script_reference\":{\"id\":\"newroom\",\"args\":{}}});\n\nexport class gameview {     \n  constructor() {\n  \tthis.game = game;\n    this.game_state = game.state.data;\n    this.send_click = function(){this.game.trigger('click',{})};\n    game.state.data.rooms = rooms;\n    game.state.data.room = {};\n    game.trigger(\"click\",{});\n  }\n}"],"sourceRoot":".."}