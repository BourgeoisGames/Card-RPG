{"version":3,"sources":["src/app.js","src/environment.js","src/main.js","src/scriptinjector.js","src/game_logic/engine.js","src/game_logic/init_game.js","src/game_logic/init_state.js","src/game_logic/narrative_system.js","src/game_logic/skill_system.js","src/resources/index.js","src/views/gameview.js","src/views/skillview.js"],"names":["App","flame_img_url","debug","testing","configure","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","scriptinjector","defaultBindingMode","oneWay","attached","url","scripttag","document","createElement","isAsync","async","setAttribute","body","appendChild","detached","remove","is_type","x","y","undefined","is_array","Array","isArray","is_type_array","every","e","is_object_type_array","is_union_type","some","is_primitive","is_datum","is_data_object","is_data_pair","Object","entries","is_value","copy","JSON","parse","stringify","is_event","event_id","data","is_script_reference","id","args","is_executable","scripts","is_script","script","is_trigger_list","game_data_model","schema","game_controller","state","data_model","add_trigger","that","triggers","trigger_id","signal_id","script_reference","signals","push","remove_trigger","arr","index","indexOf","splice","add_script","validate_game_data","bad_data","forEach","obj_type","bad_instances","type_id","objl","obj","length","get_by_type_and_id","type","tid","cop","get_by_type_and_ids","tids","map","get_script","sid","get_triggers","ans","handle_error","err","console","log","run_script","ref","interrupted","full_args","sc","halt_stack","resume_stack","clear_stack","trigger","tr","trigger_args","add_scripts","keys","script_id","yuri","yuri2","yuri3","classroom","spiderweb","bullying","just_monika","treasure","swamp","ruins_exterior","ruins_interior","city","trap","tavern","death","sample_deck","sample_cards","rooms","init_state","model","room","player","deck","card","set_room","gc","skill_event","room_id","next_room","next","game","shuffle","array_in","array","i","j","Math","floor","random","temp","remove_value","value","pick","skill_test_levels","get_card","cid","get_deck","get_skill_test_level","lid","draw_skill_test_hand","skill_test","shuffled","components","counts","tag","level","num_cards_to_draw","hand","tags","generate_skill_test_dcs","dcs","distribution","get_score_result","scores","result","leftover","score","dc","get_scores","cids","get_skill_test_result","sample_skill_event","resolve_skill_test","cards","outcomes","outcome","val","parseInt","key","isNaN","do_skill_event","config","gameview","send_click","game_state","skillview","play_cards","select_card","selected","bind","yy"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n    //this.event = new Event('just monika')\n    this.flame_img_url = \"https://media.giphy.com/media/fly1dGJ5CekcU/giphy.gif\";\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import {bindingMode, customElement, bindable, noView} from \"aurelia-framework\";\n \n@noView()\n@customElement('scriptinjector')\nexport class scriptinjector {\n \n  @bindable url;\n  @bindable isAsync;\n  @bindable({defaultBindingMode: bindingMode.oneWay}) scripttag;\n \n  attached() {\n    if (this.url) {\n      this.scripttag = document.createElement('script');\n      if (this.isAsync) {\n        this.scripttag.async = true;\n      }\n      this.scripttag.setAttribute('src', this.url);\n      document.body.appendChild(this.scripttag);\n    }\n  }\n \n  detached() {\n    if (this.scripttag) {\n      this.scripttag.remove();\n    }\n  }\n}","//some utilities\n\n//alert(\"hell\");\n\nvar is_type = (x, y) => (x !== undefined) && (typeof x == y); //check if primitive fields are the correct primitive\nvar is_array = x => Array.isArray(x);\nvar is_type_array = (x,y) => is_array(x) && x.every(e => is_type(e,y));\nvar is_object_type_array = (x,y) => is_array(x) && x.every(y);\nvar is_union_type = (x,y) => is_type_array(y,\"string\") && y.some(e => is_type(x,e));\nvar is_primitive = x => is_union_type(x,[\"string\",\"number\",\"boolean\"]) || is_object_type_array(x,is_primitive);\nvar is_datum = x => is_primitive(x) || is_data_object(x) || is_object_type_array(is_data_object);\nvar is_data_pair = x => is_array(x) && is_type(x[0],\"string\") && is_datum(x[1]);\nvar is_data_object = x => is_type(x,\"object\") && Object.entries(x).every(is_data_pair);\nvar is_value = (x,y) => x == y;\n\nvar copy = x => JSON.parse(JSON.stringify(x));\n\n//the meat\n\nvar is_event = x => is_data_object(x) && is_type(x.event_id,\"string\") && is_type(x.data,\"object\");//data is mutable, and used to store whatever the dickens\n\n//var is_display_data = x => is_type(x.display_id,\"string\") && is_type(x.args,\"object\");\n\n//var is_displayable = x => is_display_data(x.display_data);\n\nvar is_script_reference = x => is_type(x,\"object\") && is_type(x.id, \"string\") && is_type(x.args,\"object\");\n\nvar is_executable = x => is_type(x,\"object\") && is_object_type_array(x.scripts,is_script_reference);\n\nvar is_script = x => is_type(x,\"object\") && is_type(x.id,\"string\") && is_type(x.script,\"function\"); //should take in a game state object, an arguments object, and \n\n//var is_trigger = x => is_data_object(x) && is_type(x,\"object\") && is_type(x.signal_id,\"string\") && is_script_reference(x.id);\n\nvar is_trigger_list = x => is_type_array(x,\"string\");//eventids\n\n//is_message_event = x => is_event(x) && is_value(x.event_type,\"message\") && is_type(x.event_data.message, \"string\");\n\n//is_messages_event = x => is_event(x) && is_value(x.event_type,\"messages\") && is_type_array(x.event_data.messages, \"string\");\n\n//test_message_event = {message: \"my heart is pounding!\"};\n\n//test_messages_event = {messages: [\"my heart is pounding!\",\"I slice the bread, and feed myself again\"]};\n\n//test_script_event = {script_id: \"the epiphony\", args: {\"reality\":false, \"love\":\"player-kun\", \"yandere_score\":Number.MAX_VALUE}};\n\n//test_bad_script_event = {script_id: \"sayori's room\", args: {\"reaction\": w => (x => x(x))((x => x(x)))}};\n\nvar game_data_model = {};//this is loaded, and then static, and should NEVER mutate\n//game_data_model.triggers = {schema:is_trigger_list,data:{}};//triggers WILL CHANGE\n//game_data_model.events = {schema:is_event,data:{}};\ngame_data_model.scripts = {schema:is_script,data:{}};\ngame_data_model.data = {};\n\n//sig = {\"signal_id\":\"dialogue_option_1\", \"data\":{\"bullying\":false}};//this is from aurelia, and gets sent to the game_controller\n\n//quetzalcuatl = {\"signal_id\":\"dialogue_option_1\", \"event_id\":\"player_rejects_confession\"}//triggers have data too;\n\n//tezcotlipoca = {\"event_id\":\"player_accepts_confession\", \"data\":{\"sayori's heart\":\"broken\"}} //if no scripts apply; is_event -> true\n\n//xochiquetzal = {\"event_id\":\"player_accepts_confession\", \"data\":{\"sayori's heart\":\"broken\"}, \"scripts\":[xipe]}//is_event -> true; is_executable -> true\n\n//{\"sayori's heart\":\"broken\", \"trigger_data\":{\"bullying\":false}}\n\n//xipe = {\"id\":\"sayori's room\", \"args\":{\"items\":[\"rope\",\"tears\"]}}\n\n//\n\n//tlazal = {id:\"sayori's room\", script:w => (x => x(x))((x => x(x)))}\n\n//w => (x => x(x))((x => x(x))) //kill yourself\n\n//////////////////////////////////\nvar game_controller = {};\ngame_controller.state = {\n  \"interrupted\":false,\n  \"script_stack\":[],\n  \"triggers\":{},//trigger_id, script_id\n  \"signals\":{},//signal_id, [trigger_ids]\n  \"data\":{}\n};//require(\"./game_state_prototype.json\"); //this is the only non-temporary, mutable object in the game!!!\ngame_controller.data_model = game_data_model;//never touch this directly\n\ngame_controller.add_trigger = function(x){//x = {trigger_id:\"\", signal_id:\"\", script_reference:{some script reference}}\n  var that = this; \n  that.state.triggers[x.trigger_id] = {\"signal_id\":x.signal_id, \"script_reference\":x.script_reference};\n  if(!that.state.signals[x.signal_id]){that.state.signals[x.signal_id] = [];}\n  that.state.signals[x.signal_id].push(x.trigger_id);\n};\n\ngame_controller.remove_trigger = function(x){\n  var that = this; \n  var arr = that.state.signals[that.state.triggers[x].signal_id]\n  var index = arr.indexOf(x);\n  if (index !== -1) arr.splice(index, 1);\n  that.state.triggers[x] = undefined;\n};\n//game_controller.add_game_event = function(x){var that = this.data_model; that.events.data[x.event_id] = x;};\ngame_controller.add_script = function(x){var that = this; that.data_model.scripts.data[x.id] = x;};\n\ngame_controller.validate_game_data = function(){\n  var that = this.data_model;\n  var bad_data = {};\n  Object.entries(that).forEach(function(obj_type){\n    var bad_instances = [];\n    var type_id = obj_type[0];\n    var schema = obj_type[1].schema;\n    if (!schema) {return 1;}\n    Object.entries(obj_type[1].data).forEach(function(objl){\n      var obj = objl[1]\n      if(!schema(obj)){\n        bad_instances.push(obj);\n      }\n    });\n    if(bad_instances.length > 0){\n      bad_data[type_id] = bad_instances;\n    }\n  });\n  return bad_data\n};\n\ngame_controller.get_by_type_and_id = function(type,tid){\n  var that = this;\n  var cop = copy(that.data_model.data[type][tid]);\n  cop.id = tid;\n  return cop;\n};\n\ngame_controller.get_by_type_and_ids = function(type,tids){\n  var that = this;\n  return tids.map(x => that.get_by_type_and_id(type,x));\n};\n\ngame_controller.get_script = function(sid){\n  var that = this;\n  return that.data_model.scripts.data[sid];\n};\n\n\n\n/*game_controller.get_event = function(eid){\n  var that = this;\n  return copy(that.get_by_type_and_id(\"events\",eid));\n};*/\n\ngame_controller.get_triggers = function(tid){\n  var that = this;\n  var ans = that.state.signals[tid];\n  if (ans) {return ans;}\n  return [];\n};\n\ngame_controller.handle_error = function(err){\n  console.log(err);\n};\n\ngame_controller.run_script = function(ref){//takes a script reference and list of arguments\n  var that = this;\n  if (that.interrupted) {return 1;}\n  var full_args = copy(ref.args)\n  var sc = that.get_script(ref.id).script;\n  \n  return sc(that,full_args);\n};\n\ngame_controller.halt_stack = function(tid){\n  var that = this;\n  return that.interrupted = true;\n};\n\ngame_controller.resume_stack = function(tid){\n  var that = this;\n  return copy(that.state.signals[tid]);\n};\n\ngame_controller.clear_stack = function(tid){\n  var that = this;\n  return copy(that.state.signals[tid]);\n};\n\n/*game_controller.execute_script = function(sid, args){\n  var that = this;\n  that.get_script(sid)(that,args);\n};\n\ngame_controller.push_event = function(eid,data_obj){\n  var that = this;\n  var ev = that.get_event(eid)(that.state,args);\n  ev.data.call_data = data_obj;\n  that.state.event_stack.push(ev);\n};\n\ngame_controller.create_and_push_event = function(ev){//this is weird\n  var that = this;\n  that.state.event_stack.push(ev);\n};\n\ngame_controller.end_event = function(){//do not use!!\n  var that = this;\n  var ev = that.state.event_stack.pop();\n  that.state.current_event = ev;\n};*/\n\n/*game_controller.execute_event = function(){//never use\n  var that = this;\n  var ev = that.state.current_event;\n  var unloaded = !ev;\n  if(ev && is_executable(ev)){\n    ev.scripts.forEach(function (scr){\n      var args2 = clone(src.args)\n      args2.event_data = ev.data\n      args2.trigger_data = ev.trigger_data\n      that.execute_script(src.id, args2);\n    });\n  }\n  that.end_event();\n  if(unloaded){\n    that.execute_event;\n  }\n};*/\n\n/*game_controller.execute_event_stack = function(){//use this instead\n  var that = this;\n  that.execute_event();\n  var ev = !that.state.current_event;\n  if(!ev){\n    that.execute_event();\n  }\n  ev = !that.state.current_event;\n  if(ev){\n    that.execute_event_stack();\n  }\n};*/\n\ngame_controller.trigger = function(signal_id,args){\n  var that = this;\n  that.state.interrupted = false;\n  that.get_triggers(signal_id).forEach(function(tid){\n    var tr = copy(that.state.triggers[tid]);\n    var ref = tr.script_reference;\n    ref.args.trigger_args = copy(args)\n    that.run_script(ref);\n  });\n\n  that.interrupted = false;\n};\n\ngame_controller.add_scripts = function(obj){\n  var that = this;\n  Object.keys(obj).forEach(script_id => {\n    var script = obj[script_id];\n    that.add_script({\"id\":script_id,\"script\":script});\n  });\n}\n\nexport default game_controller;\n\n//document.write(\"asdsaaf\");\n\n//module.exports = game_controller;","import game from \"./engine\"\n\nimport init_skill_system from \"./skill_system\"\ninit_skill_system(game);\n\nimport init_narrative_system from \"./narrative_system\"\ninit_narrative_system(game);\n\nimport init_state from \"./init_state\"\ninit_state(game);\n\nexport default game;","var yuri = \"https://vignette.wikia.nocookie.net/doki-doki-literature-club/images/7/72/Yuri_school_1.png/revision/latest?cb=20171112095243\";\nvar yuri2 = \"https://vignette.wikia.nocookie.net/doki-doki-literature-club/images/1/19/Yurifull1.png/revision/latest?cb=20171203145750\";\nvar yuri3 = \"https://cdn140.picsart.com/251511791012212.png?r240x240\";\nvar classroom = \"https://vignette.wikia.nocookie.net/doki-doki-literature-club/images/8/87/Alt_classroom.jpeg/revision/latest?cb=20171211171811\";\nvar spiderweb = \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuz8PqsGP11FE5pFLY72RpulXoUM9XHtWEMrAZy7T3IGbEd_bX\";\nvar bullying = \"https://lparchive.org/Doki-Doki-Literature-Club/Update%2027/24-kJ6nlqg.gif\";\nvar just_monika = \"https://vignette.wikia.nocookie.net/galnet/images/f/f8/Vikax.png/revision/latest?cb=20130709221406\";\nvar treasure = \"https://i.redditmedia.com/HwYQt93EgUAe8ao14otx6k2SErTDVoGh6ZzIFc-dEb0.jpg?w=768&s=6dbe34fe968f971b3f44642effc1434b\";\nvar swamp = \"https://cdna.artstation.com/p/assets/images/images/002/879/742/large/marius-janusonis-4.jpg\";\nvar ruins_exterior = \"https://img00.deviantart.net/8ca0/i/2012/288/1/f/forgotten_glory_by_jonasdero-d3jkcvy.jpg\";\nvar ruins_interior = \"https://i.redditmedia.com/6qWKlYJin05ZvDkFaFpk6U34H41siyq5a3ji5Y4d6ho.jpg?w=1024&s=be2d3837db21c90d9eaa4a4351c908c5\";\nvar city = \"https://i.redditmedia.com/T0-eQaOlaNXPRk4Jwr_2SNj1sW2OlPxYh4alr93WTGg.jpg?w=1024&s=9107f09f413a2ace411b773dbc8bde04\";\nvar trap = \"https://www.wildwestmotorsportspark.com/wp-content/uploads/2016/03/rocks-foreground.png\";\nvar tavern = \"https://cdna0.artstation.com/p/assets/images/images/003/187/064/large/aleksandra-mokrzycka-1-4.jpg?1470780461\";\nvar death = \"https://cdnb.artstation.com/p/assets/images/images/000/612/163/large/vitor-hudson-5.jpg?1428526789\";\n\n\nvar sample_deck = ['fury','smash','endure',\n'combat reflexes','charge',\n'roar','grapple','smash',\n'charge','endure','hunters eye',\n'fury','smash','endure',\n'combat reflexes','charge',\n'roar','grapple','smash',\n'charge','endure','hunters eye',\n'fury','smash','endure',\n'combat reflexes','charge',\n'roar','grapple','smash',\n'charge','endure','hunters eye'];\n\nvar sample_cards = {\n\t\"fury\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"fury\",\n\t\t\"description\":\"Terrible stregth with purpose, but not thought\",\n\t\t\"damage\":5,\n\t\t\"defense\":-1,\n\t\t\"cost\":2,\n\t\t\"tags\":['menacing','quick','mighty','determined']\n\t},\n\t\"smash\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"smash\",\n\t\t\"description\":\"Crude, but effective\",\n\t\t\"damage\":3,\n\t\t\"defense\":0,\n\t\t\"cost\":2,\n\t\t\"tags\":['mighty']\n\t},\n\t\"endure\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"endure\",\n\t\t\"description\":\"A body like iron, tempered in battle\",\n\t\t\"damage\":0,\n\t\t\"defense\":1,\n\t\t\"cost\":0,\n\t\t\"tags\":['mighty','determined']\n\t},\n\t\"combat reflexes\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"combat reflexes\",\n\t\t\"description\":\"A mixture of instinct and experience\",\n\t\t\"damage\":0,\n\t\t\"defense\":1,\n\t\t\"cost\":0,\n\t\t\"tags\":['quick']\n\t},\n\t\"charge\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"charge\",\n\t\t\"description\":\"Flashing forth like lightning; closing the distance\",\n\t\t\"damage\":3,\n\t\t\"defense\":0,\n\t\t\"cost\":2,\n\t\t\"tags\":['mighty','quick','menacing']\n\t},\n\t\"roar\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"war cry\",\n\t\t\"description\":\"BLOOD! DEATH! AND VENGENCE!!!\",\n\t\t\"damage\":0,\n\t\t\"defense\":1,\n\t\t\"cost\":1,\n\t\t\"tags\":['menacing','determined']\n\t},\n\t\"grapple\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"grapple\",\n\t\t\"description\":\"Close enough to feel their breath\",\n\t\t\"damage\":1,\n\t\t\"defense\":0,\n\t\t\"cost\":4,\n\t\t\"tags\":['mighty','cunning']\n\t},\n\t\"hunters eye\":{\n\t\t\"img\":just_monika,\n\t\t\"name\":\"hunter\\'s eye\",\n\t\t\"description\":\"Senses as sharp and the blades they guide\",\n\t\t\"damage\":0,\n\t\t\"defense\":0,\n\t\t\"cost\":1,\n\t\t\"tags\":['quick','cunning']\n\t}\n};\n\nvar rooms = {\n\"1\": {\n\t\"next\":2,\n\t\"message\":\"\\\"❤ Hi Player-san ❤\\\"\",\n\t\"img\":yuri,\n\t\"background\":classroom\n},\n\"2\": {\n\t\"next\":3,\n\t\"message\":\"\\\"❤ I was hoping I'd get a chance to see you here ❤\\\"\"\n},\n\"3\": {\n\t\"next\":4,\n\t\"message\":\"\\\"... but ...\\\"\"\n},\n\"4\": {\n\t\"next\":5,\n\t\"message\":\"\\\"...\\\"\"\n},\n\"5\": {\n\t\"next\":6,\n\t\"message\":\"\\\"The falling stars you wished upon\\\"\"\n},\n\"6\": {\n\t\"next\":7,\n\t\"message\":\"\\\"are cinders now, and now they're gone\\\"\"\n},\n\"7\": {\n\t\"next\":8,\n\t\"message\":\"\\\"their residue festoons my fetid fields.\\\"\",\n\t\"background\":spiderweb\n},\n\"8\": {\n\t\"next\":9,\n\t\"message\":\"\\\"The withered husks of lovers past\\\"\"\n},\n\"9\": {\n\t\"next\":10,\n\t\"message\":\"\\\"the shells are all that ever last\\\"\"\n},\n\"10\": {\n\t\"next\":11,\n\t\"message\":\"\\\"I've taken everything that they've concealed.\\\"\"\n},\n\"11\": {\n\t\"next\":12,\n\t\"message\":\"\\\"...\\\"\",\n\t\"img\":yuri2\n},\n\"12\": {\n\t\"next\":13,\n\t\"message\":\"\\\"Who ever told you life was fair?\\\"\",\n\t\"img\":yuri3\n},\n\"13\": {\n\t\"next\":1,\n\t\"message\":\"Say no to bullying\",\n\t\"img\":bullying,\n\t\"background\":null\n},\n\"journey1\": {\n\t\"next\":\"journey2\",\n\t\"message\":\"With the map you aquired yesterday as a guide, you set off\",\n\t\"background\":swamp\n},\n\"journey2\": {\n\t\"next\":\"journey3\",\n\t\"message\":\"The southern swaps have never made for a pleasant journey, with flies biting at your ears and neck at every opportunity, and the smell of the marsh in the air\"\n},\n\"journey3\": {\n\t\"next\":\"arival1\",\n\t\"message\":\"But no matter, in time...\"\n},\n\"arival1\": {\n\t\"next\":\"arival2\",\n\t\"message\":\"...you arive\",\n\t\"background\":ruins_exterior\n},\n\"arival2\": {\n\t\"next\":\"arival3\",\n\t\"message\":\"The lost city of Leauver\"\n},\n\"arival3\": {\n\t\"next\":\"arival4\",\n\t\"message\":\"To the acedemics, this is proof the Outremeri made it this far north\"\n},\n\"arival4\": {\n\t\"next\":\"inside1\",\n\t\"message\":\"To you, it is an inviting promise of ancient treasure\"\n},\n\"inside1\": {\n\t\"next\":\"inside2\",\n\t\"message\":\"You make your way inside, to find a temple sanctuary chamber still standing after all these years\",\n\t\"background\":ruins_interior\n},\n\"inside2\": {\n\t\"next\":\"inside3\",\n\t\"message\":\"By the alter you find what you're looking for\"\n},\n\"inside3\": {\n\t\"next\":\"trap1\",\n\t\"message\":\"\\\"This should fetch a good price back in town\\\", you think to yourself, as you place it in your pack\",\n\t\"background\":treasure\n},\n\"trap1\": {\n\t\"next\":\"trap2\",\n\t\"message\":\"Just then, the arch supporting the entryway collapses, and rocks begin to tumble down from above\",\n\t\"img\":trap,\n\t\"background\":ruins_interior\n},\n\"trap2\": {\n\t\"next\":\"trap3\",\n\t\"message\":\"Your eyes dart from the rubble in the entrance that blocks your escape, to the newly opened hole in the cieling\"\n},\n\"trap3\": {\n\t\"next\":\"trap_skill1\",\n\t\"message\":\"You climb over rocks and fallen marble as quickly as you can before the rest of the roof caves in and crushed you underneath\"\n},\n\"trap_skill1\": {\n\t\"next\":null,\n\t\"message\":null,\n\t\"img\":null,\n\t\"background\":null,\n\t\"script\":\n\t\t{\"id\":\"do_skill_event\",\"args\":\n\t\t\t{\"skill_event\":\n\t\t\t\t{\"skill_test\":\n\t\t\t\t\t{\"description\":\"You climb over rocks and fallen marble as quickly as you can before the rest of the roof caves in and crushes you underneath\",\n\t\t\t\t\t\"components\":\n\t\t\t\t\t\t[{\"tag\":\"quick\",\"level\":\"medium\"},\n\t\t\t\t\t\t{\"tag\":\"mighty\",\"level\":\"easy\"}]\n\t\t\t\t\t},\n\t\t\t\t\"outcomes\":\n\t\t\t\t\t{0:{\"id\":\"set_room\",\"args\":{\"room_id\":\"beat_trap1\"}},\n\t\t\t\t\t\"fail\":{\"id\":\"set_room\",\"args\":{\"room_id\":\"fail_trap1\"}}}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n},\n\"fail_trap1\": {\n\t\"next\":null,\n\t\"message\":\"\\\"Your time has come, child\\\"\",\n\t\"background\":death\n},\n\"beat_trap1\": {\n\t\"next\":\"winning1\",\n\t\"message\":\"You scramble out just in time, and decide to head back to town with your new prize\",\n\t\"background\":ruins_exterior\n},\n\"winning1\": {\n\t\"next\":\"winning2\",\n\t\"message\":\"Somehow the swamp almost seems friendly on your way back, perhaps because you have wealth and triumph on your mind\",\n\t\"background\":swamp\n},\n\"winning2\": {\n\t\"next\":\"winning3\",\n\t\"message\":\"Ah, there it is: Breinhelm; home sweet home.\",\n\t\"background\":city\n},\n\"winning3\": {\n\t\"next\":\"winning4\",\n\t\"message\":\"Sure enough, you manage to sell off that Outremeri artifact you found for 250 stones of silver\"\n},\n\"winning4\": {\n\t\"next\":\"winning5\",\n\t\"message\":\"You go to the pub to celebrate\",\n\t\"background\":tavern\n},\n\"winning5\": {\n\t\"message\":\"\\\"Drinks are on me tonight lads! You can thank the Outremeri\\\"\"\n}\n};\n\nvar init_state = x => {\n\tvar state = x.state.data;\n\tvar model = x.data_model.data;\n\tmodel.room = rooms;\n    state.room = x.get_by_type_and_id(\"room\",\"journey1\");\n    state.player = {};\n    state.player.deck = sample_deck;\n    model.card = sample_cards;\n};\n\nexport default init_state;","var set_room = function(gc,args) {\n\tif (gc.state.data.skill_event){\n\t\treturn 1;\n\t}\n\tvar room_id = args.room_id\n\tvar room = gc.get_by_type_and_id(\"room\",room_id);\n\tif (!room) {return 1;}\n\tObject.keys(room).forEach(function(x){\n\t\tgc.state.data.room[x] = room[x];\n\t});\n\tif (room.script) {\n\t\tgc.run_script(room.script);\n\t}\n};\n\nvar next_room = function(gc,args) {\n\tif (!gc.state.data.room) {return 1;}\n\tvar room_id = gc.state.data.room.next;//shift();\n\tif (!room_id) {return 1}\n\tgc.run_script({\"id\":\"set_room\",\"args\":{\"room_id\":room_id}});\n};\n\nexport default game => {\ngame.add_script({\"id\":\"next_room\",\"script\":next_room});\ngame.add_script({\"id\":\"set_room\",\"script\":set_room});\ngame.add_trigger({\"trigger_id\":\"click_to_next\", \"signal_id\":\"click\", \"script_reference\":{\"id\":\"next_room\",\"args\":{}}});\n}\n","var copy = x => JSON.parse(JSON.stringify(x));\nfunction shuffle(array_in) {\n\tvar array = copy(array_in);\n    for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n    }\n    return array;\n};\nfunction remove_value(arr,value) {\n\tvar index = arr.indexOf(value);\n\tif (index >= 0) {\n  \t\tarr.splice( index, 1 );\n\t}\n}\nvar pick = x => x[Math.floor(Math.random()*x.length)];\n\n/*var sample_deck = ['fury','smash','endure',\n'combat reflexes','charge',\n'roar','grapple','smash',\n'charge','endure','hunters eye',\n'fury','smash','endure',\n'combat reflexes','charge',\n'roar','grapple','smash',\n'charge','endure','hunters eye',\n'fury','smash','endure',\n'combat reflexes','charge',\n'roar','grapple','smash',\n'charge','endure','hunters eye'];\n\nvar sample_cards = {\n\t\"fury\":{\n\t\t\"name\":\"fury\",\n\t\t\"description\":\"Terrible stregth with purpose, but not thought\",\n\t\t\"damage\":5,\n\t\t\"defense\":-1,\n\t\t\"cost\":2,\n\t\t\"tags\":['menacing','quick','mighty','determined']\n\t},\n\t\"smash\":{\n\t\t\"name\":\"smash\",\n\t\t\"description\":\"Crude, but effective\",\n\t\t\"damage\":3,\n\t\t\"defense\":0,\n\t\t\"cost\":2,\n\t\t\"tags\":['mighty']\n\t},\n\t\"endure\":{\n\t\t\"name\":\"endure\",\n\t\t\"description\":\"A body like iron, tempered in battle\",\n\t\t\"damage\":0,\n\t\t\"defense\":1,\n\t\t\"cost\":0,\n\t\t\"tags\":['mighty','determined']\n\t},\n\t\"combat reflexes\":{\n\t\t\"name\":\"combat reflexes\",\n\t\t\"description\":\"A mixture of instinct and experience\",\n\t\t\"damage\":0,\n\t\t\"defense\":1,\n\t\t\"cost\":0,\n\t\t\"tags\":['quick']\n\t},\n\t\"charge\":{\n\t\t\"name\":\"charge\",\n\t\t\"description\":\"Flashing forth like lightning; closing the distance\",\n\t\t\"damage\":3,\n\t\t\"defense\":0,\n\t\t\"cost\":2,\n\t\t\"tags\":['mighty','quick','menacing']\n\t},\n\t\"war cry\":{\n\t\t\"name\":\"war cry\",\n\t\t\"description\":\"BLOOD! DEATH! AND VENGENCE!!!\",\n\t\t\"damage\":0,\n\t\t\"defense\":1,\n\t\t\"cost\":1,\n\t\t\"tags\":['menacing','determined']\n\t},\n\t\"grapple\":{\n\t\t\"name\":\"grapple\",\n\t\t\"description\":\"Close enough to feel their breath\",\n\t\t\"damage\":1,\n\t\t\"defense\":0,\n\t\t\"cost\":4,\n\t\t\"tags\":['mighty','cunning']\n\t},\n\t\"hunters eye\":{\n\t\t\"name\":\"hunter\\'s eye\",\n\t\t\"description\":\"Senses as sharp and the blades they guide\",\n\t\t\"damage\":0,\n\t\t\"defense\":0,\n\t\t\"cost\":1,\n\t\t\"tags\":['quick','cunning']\n\t}\n};*/\n\nvar skill_test_levels = {\n\t\"easy\":{\n\t\t\"name\":\"normal\",\n\t\t\"description\":\"It will take effort, but no great skill\",\n\t\t\"distribution\":[0,1,1,2],\n\t\t\"num_cards_to_draw\":4\n\t},\n\t\"medium\":{\n\t\t\"name\":\"expert\",\n\t\t\"description\":\"A chance to demonstrate your expertise\",\n\t\t\"distribution\":[1,2,2,3],\n\t\t\"num_cards_to_draw\":5\n\t},\n\t\"hard\":{\n\t\t\"name\":\"masterful\",\n\t\t\"description\":\"A daunting barrier in your path, or a story to tell when you're done\",\n\t\t\"distribution\":[2,3,4,4],\n\t\t\"num_cards_to_draw\":6\n\t},\n\t\"random\":{\n\t\t\"name\":\"unknown\",\n\t\t\"description\":\"Feeling lucky?\",\n\t\t\"distribution\":[0,1,2,3,4],\n\t\t\"num_cards_to_draw\":6\n\t}\n};\n\n/*var sample_skill_test = {\n\t\"description\":\"You climb as fast as you can to escape\",\n\t\"components\":[\n\t{\"tag\":\"quick\",\"level\":\"medium\"},\n\t{\"tag\":\"mighty\",\"level\":\"easy\"}\n\t]\n};*/\n\nvar get_card = (gc,cid) => gc.get_by_type_and_id('card',cid);//copy(sample_cards[cid]);\n\nvar get_deck = gc => copy(gc.state.data.player.deck);\n\nvar get_skill_test_level = lid => copy(skill_test_levels[lid]);\n\nvar draw_skill_test_hand = function(gc,skill_test){\n\tvar deck = get_deck(gc);\n\tvar shuffled = shuffle(deck);\n\tvar components = copy(skill_test.components);\n\tvar counts = {}\n\tcomponents.forEach(e => {\n\t\tcounts[e.tag] = get_skill_test_level(e.level).num_cards_to_draw;\n\t});\n\tvar hand = [];\n\tshuffled.forEach(cid => {\n\t\tvar card = get_card(gc,cid);\n\t\tvar tag = null;\n\t\tcard.tags.forEach(e => {\n\t\t\tif (counts[e]) {\n\t\t\t\ttag = e;\n\t\t\t}\n\t\t});\n\t\tif (tag) {\n\t\t\tcounts[tag] -= 1;\n\t\t\thand.push(cid);\n\t\t}\n\t});\n\treturn hand;\n};\n\nvar generate_skill_test_dcs = function(skill_test){\n\tvar components = copy(skill_test.components);\n\tvar dcs = {}\n\tcomponents.forEach(e => {\n\t\tdcs[e.tag] = pick(get_skill_test_level(e.level).distribution);\n\t});\n\treturn dcs;\n};\n\nvar get_score_result = function(dcs,scores){\n\tvar result = 0;\n\tvar leftover = 0;\n\tObject.keys(dcs).forEach(e => {\n\t\tvar score = scores[e];\n\t\tif(!score) score = 0;\n\t\tvar dc = dcs[e];\n\t\tif (score <= dc) {\n\t\t\tresult += (score - dc);\n\t\t}\n\t\telse{\n\t\t\tleftover += (score - dc);\n\t\t}\n\t});\n\tresult += Math.floor(leftover/2);\n\treturn result;\n};\n\nvar get_scores = function(gc,cids){\n\tvar scores = {};\n\tcids.forEach(cid => {\n\t\tvar card = get_card(gc,cid);\n\t\tcard.tags.forEach(tag => {\n\t\t\tif (scores[tag]) {\n\t\t\t\tscores[tag] += 1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tscores[tag] = 1;\n\t\t\t}\n\t\t});\n\t});\n\treturn scores;\n};\n\nvar get_skill_test_result = function(gc,cids,skill_test){\n\tvar scores = get_scores(gc,cids);\n\tvar dcs = generate_skill_test_dcs(skill_test);\n\tvar result = get_score_result(dcs,scores);\n\t//console.log(\"--------\")\n\t//console.log(scores)\n\t//console.log(dcs)\n\t//console.log(result)\n\t//console.log(\"--------\")\n\treturn result;\n};\n\nvar sample_skill_event = {\n\t\"skill_test\":{},\n\t\"outcomes\":{\n\t\t1:{\"id\":\"newroom\",\"args\":{}}\n\t}\n}\n\nvar resolve_skill_test = function(gc,args){\n\tvar cids = args.trigger_args.cards;\n\tvar skill_event = gc.state.data.skill_event;\n\tvar skill_test = skill_event.skill_test;\n\tvar outcomes = skill_event.outcomes;\n\tvar result = get_skill_test_result(gc,cids,skill_test);\n\t\n\tvar outcome = -10000;\n\tObject.keys(outcomes).forEach(key => {\n\t\tvar val = parseInt(key);\n\t\t//alert(val)\n\t\t//alert(result >= val && !isNaN(val))\n\t\tif ((!isNaN(val)) && (result >= val) && (val >= outcome)) {\n\t\t\t//alert(\"kkaad\");\n\t\t\toutcome = val;\n\t\t}\n\t});\n\t//alert(outcome)\n\tif (!(outcome > -10000)) {\n\t\toutcome = \"fail\";\n\t}\n\tvar ref = outcomes[outcome];\n\t//alert(JSON.stringify(ref))\n\tgc.remove_trigger(\"played_cards_to_resolve_skill_event\");\n\tgc.state.data.skill_event = undefined;\n\tgc.run_script(ref,{});\n};\n\nvar do_skill_event = function(gc,args){\n\tvar skill_event = args.skill_event;\n\tgc.state.data.skill_event = skill_event;\n\tgc.state.data.player.hand = draw_skill_test_hand(gc,skill_event.skill_test);\n\tgc.add_trigger({\n\t\t\"trigger_id\":\"played_cards_to_resolve_skill_event\",\n\t\t\"signal_id\":\"played_cards\", \n\t\t\"script_reference\":{\"id\":\"resolve_skill_test\",\"args\":{}}\n\t});\n}\n\n//console.log(draw_skill_test_hand(sample_deck,sample_skill_test));\n//var sample_dcs = generate_skill_test_dcs(sample_skill_test);\n//var sample_scores = {\"mighty\":4,\"quick\":0};\n//console.log(sample_dcs);\n//console.log(get_score_result(sample_dcs,sample_scores));\n//console.log(get_scores(['charge','charge']));\n//console.log(get_skill_test_result(['charge','charge'],sample_skill_test))\n\nvar scripts = {\n\t\"do_skill_event\":do_skill_event,\n\t\"resolve_skill_test\":resolve_skill_test\n};\n\nexport default gc => gc.add_scripts(scripts);","export function configure(config) {\n  //config.globalResources([]);\n}\n","import game from \"../game_logic/init_game\"\n\nexport class gameview {     \n  constructor() {\n  \tthis.send_click = function(){this.game.trigger('click',{})};\n  \tthis.game = game;\n    this.game_state = game.state.data;\n  }\n}","import {bindable} from 'aurelia-framework';\n\nvar remove_value = (arr,value) => {\n  var index = arr.indexOf(value);\n  if (index >= 0) {\n      arr.splice( index, 1 );\n  }\n}\n\nexport class skillview {\n  @bindable game = {};\n  constructor() {\n  \tthis.play_cards = function(){\n      var that = this\n      that.game.trigger('played_cards',{\"cards\":that.cards});\n    };\n    this.select_card = card =>{\n      var that = this\n      if (card.selected) {\n        remove_value(that.cards,card.id);\n        card.selected = false;\n      }\n      else{\n        that.cards.push(card.id);\n        card.selected = true;\n      }\n      //alert(that.cards);\n    }\n  \tthis.cards = [];\n    this.hand = [];\n  }\n  bind() {\n    this.hand = this.game.get_by_type_and_ids('card',this.game.state.data.player.hand);\n    this.hand = this.hand.map(x => {\n      var yy = x;\n      yy.selected = false;\n      return yy;\n    });\n  }\n};"],"sourceRoot":".."}